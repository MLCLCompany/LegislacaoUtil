<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
          <script src="https://www.gstatic.com/firebasejs/3.6.3/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>


<script type="text/javascript"> 
// Initialize Firebase
  var config = {
     apiKey: "AIzaSyC2FllVmQgH-3yt7_SdW1N6ham_ubFYaPg",
    authDomain: "legislacaoutil.firebaseapp.com",
    databaseURL: "https://legislacaoutil.firebaseio.com",
    storageBucket: "legislacaoutil.appspot.com",
    messagingSenderId: "546399102928"
  };
  firebase.initializeApp(config);


function saveToList() {
   var dl = document.getElementById('dl').value.trim();
   var descricao = document.getElementById('descricao').value.trim();
   var titulo = document.getElementById('titulo').value.trim();
   saveToFB(titulo, dl, descricao);
   document.getElementById('dl').value = '';
   document.getElementById('descricao').value = '';
   document.getElementById('titulo').value = '';
   return false;
};
 
function saveToFB(titulo, dl, descricao) {
    // this will save data to Firebase
    firebase.database().ref('dls/').push({
        dl: dl,
        titulo: titulo,
        descricao: descricao
    });
};


function apagas(key){
	firebase.database().ref('dls/').child(key).remove();
};

function refreshUI(list) {
    var lis = '';
    for (var i = 0; i < list.length; i++) {
        lis+='<br><br><span id="'+ list[i].key +'">';
        lis+=' | ' + list[i].dl;
        lis+=' | ' + list[i].titulo + ' | <a href="" onclick="apagas(\''+list[i].key+'\');">DELETE</a></span>';
    };    
    document.getElementById('list').innerHTML = lis;
};
 
firebase.database().ref('dls/').on("value", function(snapshot) {
    var data = snapshot.val();
    var list = [];
    for (var key in data) {
        if (data.hasOwnProperty(key)) {
            titulo = data[key].titulo ? data[key].titulo : '';
            dl = data[key].dl ? data[key].dl : '';
            descricao = data[key].descricao ? data[key].descricao : '';
            if ((titulo.trim().length > 0) /*&& day==descricao*/) {
                list.push({
                    titulo: titulo,	
      				  dl: dl,
       				  descricao: descricao,			
                    key: key
                })
            }
        }
    }
    // refresh the UI
    refreshUI(list);
});
</script>
    </head>
    <body>
        Título:<input type="text" id="titulo"><br>
        DL<input type="text" id="dl"><br>
        Descrição<input type="text" id="descricao"><br>
        <button onclick="saveToList();">Submit</button>
        <div id="list"></div>
    </body>
</html>
